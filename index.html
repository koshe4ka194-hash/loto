<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Lotto Studio ‚Äî –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –õ–æ—Ç–æ</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --primary:#00E5FF;
      --accent:#FF4081;
      --glass:rgba(255,255,255,0.95);
      --dark:#121212;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:'Montserrat',sans-serif;
      background: radial-gradient(circle at center, #1a0033 0%, #000000 100%);
      color:#222; padding:20px; min-height:100vh;
    }
    .wrap{
      max-width:1100px; margin:0 auto;
      background:var(--glass); border-radius:18px;
      border:2px solid rgba(255,255,255,0.1);
      box-shadow:0 0 18px var(--primary); padding:20px;
    }
    h1{ margin:0 0 10px; text-align:center; text-transform: uppercase; letter-spacing: 2px; }
    .sub{ text-align:center; color:#444; margin-bottom:20px; font-size:13px; opacity:.9; }
    
    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    .grid3{display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px}
    
    .card{
      background:rgba(255,255,255,.6); border:1px solid rgba(0,0,0,.08);
      border-radius:14px; padding:15px; margin:12px 0;
    }
    .card h2{
      margin:0 0 10px; font-size:16px; border-bottom:2px solid var(--primary); padding-bottom:8px;
    }
    
    label{font-weight:700; font-size:11px; text-transform:uppercase; color:#555; display:block; margin-bottom: 4px;}
    input[type=text], input[type=color], select, textarea{
      width:100%; padding:10px; border-radius:8px; border:2px solid #ddd;
      font-family:inherit; outline:none; transition:.2s; background:white; font-size:14px;
    }
    input:focus, textarea:focus, select:focus{ border-color:var(--primary); box-shadow:0 0 8px rgba(0,229,255,.25); }
    textarea{ min-height:120px; font-family: monospace; }
    
    .btn-main{
      width:100%; border:none; border-radius:8px; padding:14px; cursor:pointer;
      background:linear-gradient(45deg, #2196F3, #00E5FF); color:white;
      font-weight:900; font-size:16px; text-transform:uppercase; margin-top: 10px;
      transition: transform 0.1s;
    }
    .btn-main:active{ transform: scale(0.98); }
    
    .out{
      background:#1f232a; color:#00E5FF; border-radius:12px; padding:12px;
      font-family:monospace; word-break:break-all; max-height:150px; overflow:auto;
    }
    
    .previewBox{
      background:#eee; border:1px dashed #999; border-radius:14px; padding:10px;
      margin-top: 10px;
    }
    .previewFrame{ width:100%; height:600px; border:0; background: white; border-radius: 8px; }
    
    .help{ font-size: 11px; color: #666; margin-top: 5px; }
  </style>
</head>
<body>

<div class="wrap">
  <h1>üé® Lotto Studio <span style="color:var(--accent); font-size:0.6em">v27.0 // Genially Edition</span></h1>
  <div class="sub">–°–æ–∑–¥–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –∫–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ (Embed) –≤ Genially —á–µ—Ä–µ–∑ iframe srcdoc.</div>

  <div class="grid2">
    <div class="card">
      <h2>‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
      <div class="grid2">
        <div>
          <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏–≥—Ä—ã</label>
          <input type="text" id="gTitle" value="–°–∫–∞–∑–∫–∏ –ê.–°.–ü—É—à–∫–∏–Ω–∞">
        </div>
        <div>
          <label>–¢–µ–∫—Å—Ç –ø–æ–±–µ–¥—ã</label>
          <input type="text" id="gWin" value="–ì–ï–ù–ò–ê–õ–¨–ù–û! üèÜ">
        </div>
      </div>
      <div class="grid2" style="margin-top:10px;">
        <div>
          <label>–¶–≤–µ—Ç —Å—Ç–æ–ª–∞</label>
          <input type="color" id="gColor" value="#1a472a" style="height:42px; cursor:pointer;">
        </div>
        <div>
           <label>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –∑–∞–≥–∞–¥–∫–∏</label>
           <select id="gFontSize">
             <option value="16px">–ú–µ–ª–∫–∏–π</option>
             <option value="20px" selected>–°—Ä–µ–¥–Ω–∏–π</option>
             <option value="26px">–ö—Ä—É–ø–Ω—ã–π</option>
           </select>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>üéÆ –ú–µ—Ö–∞–Ω–∏–∫–∞</h2>
      <div class="grid2">
        <div>
          <label>–†–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏</label>
          <select id="gSize">
            <option value="6">3 x 2 (6 —Ñ–∏—à–µ–∫)</option>
            <option value="8">4 x 2 (8 —Ñ–∏—à–µ–∫)</option>
          </select>
        </div>
        <div>
          <label>–¢–∏–ø –∏–≥—Ä—ã</label>
          <select id="gType">
            <option value="img">–ö–∞—Ä—Ç–∏–Ω–∫–∏ (–∏–∑ GitHub)</option>
            <option value="txt">–°–ª–æ–≤–∞ (–¢–µ–∫—Å—Ç)</option>
          </select>
        </div>
      </div>
      <div style="margin-top:10px;">
        <label>–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–∞–ø–∫—É GitHub (—Å / –≤ –∫–æ–Ω—Ü–µ)</label>
        <input type="text" id="gUrl" value="https://koshe4ka194-hash.github.io/lotto/">
        <div class="help">–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—Å—ã–ª–∫–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–ª—ç—à <b>/</b>.</div>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>üìù –ö–∞—Ä—Ç–æ—á–∫–∏ –∏ –ó–∞–≥–∞–¥–∫–∏</h2>
    <div class="help" style="margin-bottom:10px;">
      –§–æ—Ä–º–∞—Ç: <b>–ó–∞–≥–∞–¥–∫–∞ | –û—Ç–≤–µ—Ç</b>. <br>
      –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω —Ç–∏–ø "–ö–∞—Ä—Ç–∏–Ω–∫–∏", –≤ –æ—Ç–≤–µ—Ç–µ –ø–∏—à–∏—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä. <i>03.png</i>).<br>
      –ï—Å–ª–∏ —Ç–∏–ø "–°–ª–æ–≤–∞", –ø–∏—à–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ —Å–ª–æ–≤–æ.
    </div>
    <textarea id="gData">–¢–µ–∫—Å—Ç –∑–∞–≥–∞–¥–∫–∏... | –û—Ç–≤–µ—Ç
–°–∏–¥–∏—Ç –¥–µ–¥, –≤–æ —Å—Ç–æ —à—É–± –æ–¥–µ—Ç | 03.png
–ó–∏–º–æ–π –∏ –ª–µ—Ç–æ–º –æ–¥–Ω–∏–º —Ü–≤–µ—Ç–æ–º | 04.png
–†—ã–∂–∞—è –ø–ª—É—Ç–æ–≤–∫–∞ | 06.png
</textarea>
  </div>

  <button class="btn-main" onclick="generate()">–°–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨ –ò–ì–†–£</button>

  <div class="grid2" style="margin-top:20px;">
    <div class="card">
      <h2>üì§ –ö–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏</h2>
      <div class="help" style="margin-bottom:5px;">–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ Genially (Insert -> Others)</div>
      <div id="output" class="out">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–°–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨"...</div>
      <button class="btn-main" style="background:#333; margin-top:10px; font-size:12px;" onclick="copyCode()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
    </div>
    <div class="card">
      <h2>üëÄ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</h2>
      <div class="previewBox">
        <iframe id="preview" class="previewFrame"></iframe>
      </div>
    </div>
  </div>

</div>

<script>
  // ---------- –§—É–Ω–∫—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ----------

  function escapeHtml(text) {
    return text
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }

  function generate() {
    // 1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
    const title = document.getElementById('gTitle').value;
    const winText = document.getElementById('gWin').value;
    const color = document.getElementById('gColor').value;
    const size = parseInt(document.getElementById('gSize').value);
    const type = document.getElementById('gType').value;
    const fontSize = document.getElementById('gFontSize').value;
    let url = document.getElementById('gUrl').value.trim();
    if (url && !url.endsWith('/')) url += '/';

    const rawData = document.getElementById('gData').value.trim().split('\n');
    const dataArray = [];
    
    rawData.forEach(line => {
        if(line.includes('|')) {
            const parts = line.split('|');
            dataArray.push({ q: parts[0].trim(), a: parts[1].trim() });
        }
    });

    if (dataArray.length < size * 2) {
        alert(`–í–Ω–∏–º–∞–Ω–∏–µ! –î–ª—è —Å–µ—Ç–∫–∏ ${size}x2 –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º ${size * 2} –ø–∞—Ä (—É –≤–∞—Å ${dataArray.length}).`);
    }

    const cols = (size === 6) ? 3 : 4;

    // –°—Å—ã–ª–∫–∏ –Ω–∞ –∑–≤—É–∫–∏ (–∂–µ—Å—Ç–∫–æ –ø—Ä–æ–ø–∏—Å–∞–Ω—ã –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É)
    const sShake = "https://github.com/koshe4ka194-hash/lotto/raw/refs/heads/main/meshok.mp3";
    const sPlace = "https://github.com/koshe4ka194-hash/lotto/raw/refs/heads/main/fishka.mp3";
    const sWin = "https://github.com/koshe4ka194-hash/lotto/raw/refs/heads/main/victory.mp3";

    // 2. –®–∞–±–ª–æ–Ω –∏–≥—Ä—ã (–í–∞—à —Ä–∞–±–æ—á–∏–π –∫–æ–¥ v27.0)
    const gameHTML = `
<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<style>
  body { margin:0; padding:10px; background: radial-gradient(circle, ${color} 0%, #000 180%); font-family: 'Segoe UI', sans-serif; color:white; display:flex; flex-direction:column; align-items:center; min-height:100vh; overflow:hidden; user-select:none; }
  .overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); display:flex; flex-direction:column; justify-content:center; align-items:center; z-index:100; }
  
  .riddle-card { 
      width: 300px; height: 150px; background: #fdf5e6; border: 4px solid #8d6e63; border-radius: 15px;
      color: #3e2723; display: flex; align-items: center; justify-content: center; text-align: center;
      padding: 15px; box-sizing: border-box; font-size: ${fontSize}; font-weight: bold; line-height: 1.3;
      box-shadow: 0 10px 25px rgba(0,0,0,0.5); overflow-y: auto; position: relative; margin-bottom: 10px;
      transition: transform 0.3s;
  }
  
  .btn { background:linear-gradient(180deg, #ffb74d, #f57c00); color:white; border:none; padding:10px 25px; border-radius:10px; font-weight:bold; cursor:pointer; box-shadow:0 4px 0 #b71c1c; text-transform:uppercase; font-size:14px; }
  .btn:active { transform:translateY(2px); box-shadow:0 2px 0 #b71c1c; }
  .btn-reset { margin-top:20px; background:#607d8b; box-shadow:0 4px 0 #37474f; font-size:10px; }

  .row { display:flex; gap:15px; justify-content:center; width:98%; max-width:900px; }
  .card { background:white; border-radius:15px; padding:10px; flex:1; box-shadow:0 10px 20px rgba(0,0,0,0.4); color:#333; min-width:250px; }
  
  .grid { display:grid; grid-template-columns: repeat(${cols}, 1fr); gap:8px; margin-top:10px; }
  .chip { height: 80px; background:white; border-radius:12px; border:2px solid #eee; display:flex; align-items:center; justify-content:center; cursor:pointer; position:relative; overflow:hidden; text-align:center; padding:2px; font-weight:bold; font-size:13px; word-break: break-word; }
  .chip:hover { border-color: #f57c00; }
  .chip img { width:95%; height:95%; object-fit:contain; }
  
  .chip.ok::after { content:"‚úî"; position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(46, 204, 113, 0.9); color:white; display:flex; align-items:center; justify-content:center; font-size:40px; font-weight:bold; animation: pop 0.3s; }
  @keyframes pop { 0% {transform:scale(0);} 100% {transform:scale(1);} }

  #st { font-weight:bold; font-size:20px; text-align:center; margin-bottom:10px; height:24px; text-shadow:0 2px 4px rgba(0,0,0,0.5); color:#ffca28; }
</style>
</head>
<body>

<div id="startLayer" class="overlay">
    <h2 style="color:white; margin-bottom:20px; text-align:center;">${title}</h2>
    <button class="btn" onclick="startGame()">–ù–ê–ß–ê–¢–¨ –ò–ì–†–£</button>
</div>

<h2 style="margin:0 0 5px 0; text-align:center;">${title}</h2>
<div id="st">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É</div>

<div style="display:flex; flex-direction:column; align-items:center;">
    <div id="slot" class="riddle-card">–ù–∞–∂–º–∏—Ç–µ "–ü–û–¢–†–Ø–°–ò –ú–ï–®–û–ö"</div>
    <button class="btn" onclick="draw()">–ü–û–¢–†–Ø–°–ò –ú–ï–®–û–ö</button>
</div>

<div class="row" style="margin-top:15px;">
    <div class="card"><center><b>–ò–ì–†–û–ö 1</b></center><div id="g1" class="grid"></div></div>
    <div class="card"><center><b>–ò–ì–†–û–ö 2</b></center><div id="g2" class="grid"></div></div>
</div>

<button class="btn btn-reset" onclick="reset()">–°–ë–†–û–°–ò–¢–¨</button>

<script>
    const DATA = ${JSON.stringify(dataArray)};
    const TYPE = '${type}';
    const SIZE = ${size};
    const BASE = '${url}img/';
    
    // –ó–≤—É–∫–∏
    const aD = new Audio('${sShake}'); 
    const aP = new Audio('${sPlace}'); 
    const aW = new Audio('${sWin}');
    
    let bag = [], curr = null, winLock = false;

    function startGame() {
        [aD, aP, aW].forEach(s => { s.play().then(() => s.pause()).catch(()=>{}); });
        document.getElementById('startLayer').style.display = 'none';
        reset();
    }

    function reset() {
        curr = null; winLock = false;
        document.getElementById('slot').innerText = '–ù–∞–∂–º–∏—Ç–µ "–ü–û–¢–†–Ø–°–ò –ú–ï–®–û–ö"';
        let p = [...DATA].sort(() => Math.random() - 0.5);
        let p1 = p.slice(0, SIZE); let p2 = p.slice(SIZE, SIZE * 2);
        bag = [...p1, ...p2].sort(() => Math.random() - 0.5);
        render('g1', p1); render('g2', p2);
        document.getElementById('st').innerText = '–•–æ–¥–∏—Ç–µ!';
    }

    function render(id, items) {
        const g = document.getElementById(id); g.innerHTML = '';
        items.forEach(item => {
            const d = document.createElement('div'); d.className = 'chip';
            if(TYPE === 'img') {
                d.innerHTML = '<img src="'+BASE+item.a+'" onerror="this.parentNode.innerText=\\'‚ùå\\'">';
            } else {
                d.innerText = item.a;
            }
            d.onclick = () => {
                if(curr && item.a === curr.a) {
                    aP.currentTime=0; aP.play();
                    d.classList.add('ok'); check();
                }
            };
            g.appendChild(d);
        });
    }

    function draw() {
        if(!bag.length || winLock) return;
        aD.currentTime=0; aD.play();
        curr = bag.pop();
        // –ê–Ω–∏–º–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏
        const slot = document.getElementById('slot');
        slot.style.transform = "scale(0.9)";
        setTimeout(() => { 
            slot.innerText = curr.q; 
            slot.style.transform = "scale(1)";
        }, 300);
    }

    function check() {
        [1,2].forEach(n => {
            if(document.getElementById('g' + n).querySelectorAll('.chip.ok').length === SIZE) {
                if(!winLock) { aW.currentTime=0; aW.play(); winLock = true; }
                document.getElementById('st').innerText = '${winText}';
            }
        });
    }
<\/script>
</body>
</html>`;

    // 3. –°–æ–∑–¥–∞–µ–º srcdoc iframe
    // –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º HTML –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ –∞—Ç—Ä–∏–±—É—Ç srcdoc
    const escapedHTML = gameHTML
        .replace(/&/g, "&amp;")
        .replace(/"/g, "&quot;");

    const iframeCode = `<iframe srcdoc="${escapedHTML}" width="100%" height="700" style="border:none; background:transparent;"></iframe>`;

    // 4. –í—ã–≤–æ–¥
    document.getElementById('output').textContent = iframeCode;
    
    // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
    const previewFrame = document.getElementById('preview');
    previewFrame.srcdoc = gameHTML;
  }

  function copyCode() {
    const txt = document.getElementById('output').textContent;
    navigator.clipboard.writeText(txt).then(() => {
      alert("–ö–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω! –í—Å—Ç–∞–≤–ª—è–π—Ç–µ –≤ Genially.");
    });
  }
</script>

</body>
</html>
